# DevUp - System Architecture & Flow

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Frontend (React)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Lobby     â”‚  â”‚  Configure  â”‚  â”‚  Arena  â”‚    Results    â”‚ â”‚
â”‚  â”‚   Page      â”‚â†’ â”‚    Page     â”‚â†’ â”‚  Page   â”‚ â†’  Page       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                                 â”‚
             â”‚ HTTP/AJAX                      â”‚ Polling (2s)
             â†“                                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Backend (Laravel)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚    Lobby     â”‚  â”‚     Battle     â”‚  â”‚  Gemini Service   â”‚   â”‚
â”‚  â”‚  Controller  â”‚  â”‚   Controller   â”‚  â”‚  (AI Evaluation)  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                                 â”‚
             â”‚ Eloquent ORM                   â”‚ HTTP API
             â†“                                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Database (SQLite)          â”‚  â”‚    Gemini AI API           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  (Google Cloud)            â”‚
â”‚  â”‚Lobbies â”‚  â”‚  Histories    â”‚ â”‚  â”‚                            â”‚
â”‚  â”‚Users   â”‚  â”‚RoundHistories â”‚ â”‚  â”‚  - Challenge Generation    â”‚
â”‚  â”‚Prompts â”‚  â”‚               â”‚ â”‚  â”‚  - Code Evaluation         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  - Scoring (0-100)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Complete Game Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: LOBBY SETUP                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Host                              Guest                         â”‚
â”‚   â”‚                                  â”‚                           â”‚
â”‚   â”‚ 1. Create Lobby                 â”‚                           â”‚
â”‚   â”‚    â†“                             â”‚                           â”‚
â”‚   â”‚ Get Code: "XYZ123"              â”‚                           â”‚
â”‚   â”‚                                  â”‚                           â”‚
â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Share Code â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚                           â”‚
â”‚   â”‚                                  â”‚                           â”‚
â”‚   â”‚                                  â”‚ 2. Join Lobby             â”‚
â”‚   â”‚                                  â”‚    â†“                      â”‚
â”‚   â”‚                                  â”‚ Enter: "XYZ123"           â”‚
â”‚   â”‚                                  â”‚                           â”‚
â”‚   â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€ Guest Joins â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                           â”‚
â”‚   â”‚                                  â”‚                           â”‚
â”‚   â”‚ âœ“ Both players in lobby         â”‚ âœ“ Waiting for host        â”‚
â”‚   â”‚                                  â”‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2: CONFIGURATION (Host Only)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Host Configures:                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚ â–¶ Language: Python â–¼                    â”‚                   â”‚
â”‚   â”‚ â–¶ Difficulty: Medium â–¼                  â”‚                   â”‚
â”‚   â”‚ â–¶ Rounds: Best of 3 â–¼                   â”‚                   â”‚
â”‚   â”‚ â–¶ Type: â—‹ Debug  â— Problem Solving      â”‚                   â”‚
â”‚   â”‚                                          â”‚                   â”‚
â”‚   â”‚     [Start Battle!]                      â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                     â†“                                            â”‚
â”‚            Settings Saved to DB                                  â”‚
â”‚                     â†“                                            â”‚
â”‚            History Record Created                                â”‚
â”‚                     â†“                                            â”‚
â”‚        AI Generates First Challenge                              â”‚
â”‚                     â†“                                            â”‚
â”‚      Both Players â†’ Arena Page                                   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3: BATTLE ARENA (Both Players)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    VS    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Host: 0 pts     â”‚          â”‚  Guest: 0 pts    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ Round 1/3                      Timer: 01:23   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                  â”‚
â”‚  Challenge: "Write a function to sum two numbers"               â”‚
â”‚  Examples: sum(5, 3) â†’ 8                                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€ Code Editor (Host) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ def sum_numbers(a, b):                       â”‚              â”‚
â”‚  â”‚     return a + b                             â”‚              â”‚
â”‚  â”‚                                              â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚  [Submit Solution] â† Click                                      â”‚
â”‚           â†“                                                      â”‚
â”‚  â³ Evaluating... (5-10 seconds)                                â”‚
â”‚           â†“                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ âœ“ Submitted! Score: 95/100                â”‚                â”‚
â”‚  â”‚ AI Feedback: "Excellent! Clean solution."  â”‚                â”‚
â”‚  â”‚ â³ Waiting for opponent...                  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                  â”‚
â”‚  Guest Submits â†’ Both scores updated                            â”‚
â”‚           â†“                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    VS    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Host: 95 pts    â”‚          â”‚  Guest: 88 pts   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚           â†“                                                      â”‚
â”‚  Round 2 Starts Automatically...                                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 4: RESULTS (After All Rounds)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚                      ğŸ† VICTORY! ğŸ†                              â”‚
â”‚                                                                  â”‚
â”‚                    Host Wins!                                    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚    Host          â”‚         â”‚     Guest        â”‚             â”‚
â”‚  â”‚  ğŸ¥‡ 280 pts      â”‚         â”‚   ğŸ¥ˆ 260 pts     â”‚             â”‚
â”‚  â”‚  +100 XP         â”‚         â”‚    +50 XP        â”‚             â”‚
â”‚  â”‚  Wins: 15 â†’ 16   â”‚         â”‚   Wins: 12       â”‚             â”‚
â”‚  â”‚  Streak: 3 â†’ 4   â”‚         â”‚   Streak: 0      â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                â”‚
â”‚  Round Breakdown:                                                â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                â”‚
â”‚                                                                  â”‚
â”‚  â–¼ Round 1: Sum Two Numbers                                     â”‚
â”‚     Host: 95 pts | Guest: 88 pts                                â”‚
â”‚     [View Code Comparison] â†                                    â”‚
â”‚                                                                  â”‚
â”‚  â–¼ Round 2: Reverse String                                      â”‚
â”‚     Host: 92 pts | Guest: 90 pts                                â”‚
â”‚     [View Code Comparison]                                      â”‚
â”‚                                                                  â”‚
â”‚  â–¼ Round 3: Find Maximum                                        â”‚
â”‚     Host: 93 pts | Guest: 82 pts                                â”‚
â”‚     [View Code Comparison]                                      â”‚
â”‚                                                                  â”‚
â”‚  [Back to Lobby] [Play Again]                                   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Real-Time Updates (Polling)

```
Arena Page (Every 2 seconds):
â”‚
â”œâ”€â†’ Fetch /battle/{id}/state
â”‚   â†“
â”‚   {
â”‚     "lobby": { "current_round": 1, "status": "started" },
â”‚     "history": { "host_score": 95, "guest_score": 0 },
â”‚     "currentRound": {
â”‚       "host_submitted": true,
â”‚       "guest_submitted": false
â”‚     }
â”‚   }
â”‚   â†“
â”œâ”€â†’ Update UI:
â”‚   - Show host submitted âœ“
â”‚   - Show guest pending â³
â”‚   - Update scores
â”‚   â†“
â”œâ”€â†’ Guest Submits
â”‚   â†“
â”œâ”€â†’ Next Poll:
â”‚   {
â”‚     "lobby": { "current_round": 2 },  â† Round changed!
â”‚     "history": { "host_score": 95, "guest_score": 88 },
â”‚     "currentRound": { "round_number": 2, ... }
â”‚   }
â”‚   â†“
â”œâ”€â†’ Update UI:
â”‚   - Load new challenge
â”‚   - Reset editor
â”‚   - Update scores
â”‚   â†“
â””â”€â†’ Continue polling...

When game ends:
    "lobby": { "status": "finished" }
    â†“
    Redirect to results page
```

## ğŸ“Š Database Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Users   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  Lobbies   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚   Histories     â”‚
â”‚          â”‚ hosts   â”‚            â”‚ creates â”‚                 â”‚
â”‚  - id    â”‚         â”‚  - id      â”‚         â”‚  - id           â”‚
â”‚  - name  â”‚         â”‚  - code    â”‚         â”‚  - host_id      â”‚
â”‚  - xp    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  - host_id â”‚         â”‚  - guest_id     â”‚
â”‚  - wins  â”‚ guests  â”‚  - guest_idâ”‚         â”‚  - scores       â”‚
â”‚  - streakâ”‚         â”‚  - config  â”‚         â”‚  - winner_id    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â”‚ has many
                                                      â†“
                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                            â”‚  Round Histories    â”‚
                                            â”‚                     â”‚
                                            â”‚  - id               â”‚
                                            â”‚  - history_id       â”‚
                                            â”‚  - round_number     â”‚
                                            â”‚  - question (JSON)  â”‚
                                            â”‚  - host_code        â”‚
                                            â”‚  - guest_code       â”‚
                                            â”‚  - host_score       â”‚
                                            â”‚  - guest_score      â”‚
                                            â”‚  - evaluations      â”‚
                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Prompts  â”‚ â† Pre-seeded AI templates
â”‚          â”‚
â”‚  - id    â”‚
â”‚  - type  â”‚   (debug | problem-solving)
â”‚  - gen   â”‚   (challenge generation prompt)
â”‚  - score â”‚   (scoring prompt)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¤– AI Evaluation Flow

```
User Submits Code
      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BattleController::submitCode()              â”‚
â”‚                                              â”‚
â”‚  1. Validate code not empty                 â”‚
â”‚  2. Get current round from DB               â”‚
â”‚  3. Check not already submitted             â”‚
â”‚  4. Calculate submission time               â”‚
â”‚     â†“                                        â”‚
â”‚  5. Call GeminiService::evaluateCode()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GeminiService::evaluateCode()               â”‚
â”‚                                              â”‚
â”‚  1. Build scoring prompt:                   â”‚
â”‚     - Original question                     â”‚
â”‚     - Submitted code                        â”‚
â”‚     - Language                              â”‚
â”‚     - Game type                             â”‚
â”‚     - Submission time                       â”‚
â”‚     â†“                                        â”‚
â”‚  2. Send to Gemini API                      â”‚
â”‚     POST https://generativelanguage.../     â”‚
â”‚     â†“                                        â”‚
â”‚  3. Wait for response (5-30s)               â”‚
â”‚     â†“                                        â”‚
â”‚  4. Parse JSON response:                    â”‚
â”‚     {                                        â”‚
â”‚       "score": 85,                          â”‚
â”‚       "explanation": "Good solution...",    â”‚
â”‚       "feedback": {                         â”‚
â”‚         "correctness": "...",               â”‚
â”‚         "quality": "...",                   â”‚
â”‚         "efficiency": "...",                â”‚
â”‚         "improvements": [...]               â”‚
â”‚       }                                      â”‚
â”‚     }                                        â”‚
â”‚     â†“                                        â”‚
â”‚  5. Return evaluation                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BattleController (continued)                â”‚
â”‚                                              â”‚
â”‚  6. Save code to round_histories:           â”‚
â”‚     - host_code / guest_code                â”‚
â”‚     - submitted_at timestamp                â”‚
â”‚     - score                                 â”‚
â”‚     - evaluation JSON                       â”‚
â”‚     â†“                                        â”‚
â”‚  7. Update total score in histories         â”‚
â”‚     host_score += evaluation.score          â”‚
â”‚     â†“                                        â”‚
â”‚  8. Check if both submitted                 â”‚
â”‚     IF both submitted:                      â”‚
â”‚       IF more rounds: generate next         â”‚
â”‚       ELSE: end game                        â”‚
â”‚     â†“                                        â”‚
â”‚  9. Return evaluation to frontend           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
        UI Updates with Score
```

## ğŸ¯ Scoring Breakdown

```
Total Score: 0-100 points

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Criteria       â”‚ Points â”‚ Evaluation                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Correctness    â”‚   40   â”‚ âœ“ Solves the problem?       â”‚
â”‚                â”‚        â”‚ âœ“ Handles edge cases?       â”‚
â”‚                â”‚        â”‚ âœ“ Output correct?           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Code Quality   â”‚   30   â”‚ âœ“ Readable?                 â”‚
â”‚                â”‚        â”‚ âœ“ Well-structured?          â”‚
â”‚                â”‚        â”‚ âœ“ Best practices?           â”‚
â”‚                â”‚        â”‚ âœ“ Comments (if needed)?     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Efficiency     â”‚   20   â”‚ âœ“ Time complexity good?     â”‚
â”‚                â”‚        â”‚ âœ“ Space complexity good?    â”‚
â”‚                â”‚        â”‚ âœ“ Optimized algorithm?      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Time Bonus     â”‚   10   â”‚ âœ“ Faster = more points      â”‚
â”‚                â”‚        â”‚ âœ“ <1 min: +10 pts           â”‚
â”‚                â”‚        â”‚ âœ“ 1-2 min: +5 pts           â”‚
â”‚                â”‚        â”‚ âœ“ >2 min: +0 pts            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Example Scores:
- Perfect Solution (fast): 95-100
- Good Solution: 80-90
- Working but messy: 60-75
- Partial solution: 40-60
- Buggy code: 20-40
- Wrong/empty: 0-20
```

## ğŸ® Game Types Comparison

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEBUG CHALLENGE                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ AI Generates:                                                â”‚
â”‚  - Broken code with 2-3 bugs                                â”‚
â”‚  - Description of what it should do                         â”‚
â”‚  - Expected output                                          â”‚
â”‚  - Hints about the bugs                                     â”‚
â”‚                                                              â”‚
â”‚ Player Task:                                                 â”‚
â”‚  - Find and fix all bugs                                    â”‚
â”‚  - Make code work correctly                                 â”‚
â”‚                                                              â”‚
â”‚ Good For:                                                    â”‚
â”‚  - Learning debugging skills                                â”‚
â”‚  - Understanding common errors                              â”‚
â”‚  - Quick games (easier to fix than write)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PROBLEM SOLVING                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ AI Generates:                                                â”‚
â”‚  - Problem description                                      â”‚
â”‚  - Input/output examples                                    â”‚
â”‚  - Constraints                                              â”‚
â”‚  - Optional starter code                                    â”‚
â”‚                                                              â”‚
â”‚ Player Task:                                                 â”‚
â”‚  - Design solution                                          â”‚
â”‚  - Write code from scratch                                  â”‚
â”‚  - Handle all cases                                         â”‚
â”‚                                                              â”‚
â”‚ Good For:                                                    â”‚
â”‚  - Algorithm practice                                       â”‚
â”‚  - Creative problem solving                                 â”‚
â”‚  - Competitive programming training                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ Key Files Map

```
Backend Logic:
â”œâ”€ app/Services/GeminiService.php
â”‚  â””â”€ generateChallenge()      â†’ AI creates problem
â”‚  â””â”€ evaluateCode()            â†’ AI scores solution
â”‚
â”œâ”€ app/Http/Controllers/BattleController.php
â”‚  â”œâ”€ configure()               â†’ Show config page
â”‚  â”œâ”€ start()                   â†’ Create game
â”‚  â”œâ”€ play()                    â†’ Show arena
â”‚  â”œâ”€ getState()                â†’ API for polling
â”‚  â”œâ”€ submitCode()              â†’ Handle submissions
â”‚  â””â”€ results()                 â†’ Show results
â”‚
â””â”€ app/Http/Controllers/LobbyController.php
   â”œâ”€ index()                   â†’ Show lobby
   â”œâ”€ create()                  â†’ Create lobby
   â”œâ”€ join()                    â†’ Join lobby
   â””â”€ leave()                   â†’ Leave lobby

Frontend Pages:
â”œâ”€ resources/js/pages/lobby.tsx
â”‚  â””â”€ Lobby list, create/join UI
â”‚
â”œâ”€ resources/js/pages/battle/configure.tsx
â”‚  â””â”€ Game settings selection
â”‚
â”œâ”€ resources/js/pages/battle/arena.tsx
â”‚  â””â”€ Main battle interface
â”‚
â””â”€ resources/js/pages/battle/results.tsx
   â””â”€ Winner and breakdown

Database:
â”œâ”€ database/migrations/
â”‚  â”œâ”€ create_lobbies_table.php
â”‚  â”œâ”€ create_histories_table.php
â”‚  â”œâ”€ create_round_histories_table.php
â”‚  â”œâ”€ add_game_config_to_lobbies.php      (NEW)
â”‚  â”œâ”€ update_round_histories.php          (NEW)
â”‚  â””â”€ add_winner_to_histories.php         (NEW)
â”‚
â””â”€ database/seeders/PromptSeeder.php      (NEW)
```

## ğŸš€ Request/Response Examples

### 1. Join Lobby
```http
POST /lobby/join
Content-Type: application/json

{
  "invite_code": "XYZ123"
}

Response:
{
  "message": "Successfully joined the lobby!",
  "lobby": { ... }
}
```

### 2. Configure & Start Battle
```http
POST /battle/5/start
Content-Type: application/json

{
  "language": "python",
  "difficulty": "medium",
  "round_count": 3,
  "game_type": "problem-solving"
}

Response:
Redirect â†’ /battle/5/play
```

### 3. Get Battle State (Polling)
```http
GET /battle/5/state

Response:
{
  "lobby": {
    "id": 5,
    "current_round": 1,
    "round_count": 3,
    "language": "python",
    "status": "started"
  },
  "history": {
    "host_score": 0,
    "guest_score": 0
  },
  "currentRound": {
    "round_number": 1,
    "question": {
      "title": "Sum Two Numbers",
      "description": "Write a function...",
      "examples": [...]
    },
    "host_submitted": false,
    "guest_submitted": false
  }
}
```

### 4. Submit Code
```http
POST /battle/5/submit
Content-Type: application/json

{
  "code": "def sum_numbers(a, b):\n    return a + b"
}

Response:
{
  "success": true,
  "evaluation": {
    "score": 95,
    "explanation": "Excellent solution!",
    "feedback": {
      "correctness": "Perfect",
      "quality": "Clean code",
      "efficiency": "Optimal",
      "improvements": []
    }
  },
  "roundComplete": false
}
```

---

This diagram shows the complete system architecture and flow of your DevUp application! ğŸš€
